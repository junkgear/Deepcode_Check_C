static void flush_dpb(AVCodecContext *avctx)
{
    H264Context *h = avctx->priv_data;
    int i;
    for (i=0; i<=MAX_DELAYED_PIC_COUNT; i++) {
        if (h->delayed_pic[i])
            h->delayed_pic[i]->f.reference = 0;
        h->delayed_pic[i] = NULL;
    }
    h->outputed_poc = h->next_outputed_poc = INT_MIN;
    h->prev_interlaced_frame = 1;
    idr(h);
    h->prev_frame_num = -1;
    if (h->s.current_picture_ptr)
        h->s.current_picture_ptr->f.reference = 0;
    h->s.first_field = 0;
    ff_h264_reset_sei(h);
    ff_mpeg_flush(avctx);
    h->recovery_frame= -1;
    h->sync= 0;
}